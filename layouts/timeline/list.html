{{ define "customclasses" }}template--timeline{{ end }}

{{ define "main" }}
{{ $entries := where .Site.RegularPages "Section" .Section }}

<r-grid columns-s="4" columns="12" class="header">
    <r-cell span-s="row" span="4+6">
        <h1>Timeline</h1>
        <p class="--muted">{{ range last 1 $entries }}{{ dateFormat "2006" .Params.Date }}{{ end }} – {{ range first 1 $entries }}{{ dateFormat "2006" .Params.Date }}{{ end }}</p>
    </r-cell>
</r-grid>

{{ range $entries }}
<r-grid columns-s="4" columns="12" class="timeline__item{{ if .Params.Important }} --important{{ end }}" id="{{ .File.TranslationBaseName }}">
    <r-cell span-s="row" span="3" class="timeline__item__meta">
        <date>{{ dateFormat "Monday · January 2, 2006" .Params.Date }}</date>

        {{ if .Params.Relations }}
        <h3>Relations</h3>
        <ul class="relations --ghost">
            {{ range $relation := .Params.Relations }}
            <li>
                <a href="{{ $relation.url }}">
                    <span class="title">{{ $relation.title }}</span>
                    <span class="description">{{ $relation.platform }}</span>
                </a>
            </li>
            {{ end }}
        </ul>
        {{ end }}
    </r-cell>
    <r-cell span-s="row" span="5">
        {{ with .Title }}<h2 class="timeline__item__title">{{ . }}</h2>{{ end }}
        {{ with .Description }}<p class="timeline__item__description">{{ . }}</p>{{ end }}
        {{ if and .Params.Cover (not .Params.HideCover) }}<img src="{{ .Site.BaseURL }}{{ .Params.Cover }}" class="timeline__item__cover">{{ end }}

        {{ if eq .Params.Crop false }}
            {{ .Content | safeHTML }}
        {{ else }}
            {{ .Content | safeHTML | truncate 400 }}
            {{ if .Truncated }}
            <a href="{{ .RelPermalink }}" class="button">Read more</a>
            {{ end }}
        {{ end }}
    </r-cell>
</r-grid>
{{ end }}
{{ end }}